if("undefined"!=typeof wp&&wp.i18n){let __=wp.i18n.__}($=>{jQuery(document).ready(function(){var bb_polls_Interval,poll_html="",option_html="";function bb_pools_icon_push(){bb_polls_Interval&&clearInterval(bb_polls_Interval),bb_polls_Interval=setInterval(function(){var $toolbar;bpolls_ajax_object.buddyboss&&0==$("#whats-new-form:not(.focus-in) #whats-new-toolbar .bpolls-html-container-placeholder").length?0<($toolbar=$("#whats-new-form:not(.focus-in) #whats-new-toolbar")).length&&($toolbar.append('<div class="post-elements-buttons-item bpolls-html-container-placeholder"><span class="bpolls-icon bp-tooltip" data-bp-tooltip-pos="up" data-bp-tooltip="'+bpolls_ajax_object.add_poll_text+'"><i class="wb-icons wb-icon-bar-chart"></i></span></div>'),clearInterval(bb_polls_Interval)):clearInterval(bb_polls_Interval)},500)}function bpollsResetPollForm(){$(".bpolls-input").each(function(){$(this).val("")}),$(".bpolls-polls-option-html").html(poll_html),$(".bpolls-polls-option-html").is(":visible")&&$(".bpolls-polls-option-html").slideUp(500),$("#bpolls-image-preview").attr("src",""),$("#bpolls-attachment-url").val(""),$(".bpolls-image-upload").hide(),$("#bpolls-video-preview").attr("src",""),$("#bpolls-video-attachment-url").val(""),$(".bpolls-video-upload").hide(),$("#bpolls-audio-preview").attr("src",""),$("#bpolls-audio-attachment-url").val(""),$(".bpolls-audio-upload").hide(),$(".bpolls-sortable").sortable({handle:".bpolls-sortable-handle"}),$(".bpolls-sortable").disableSelection()}$("form#whats-new-form").attr("enctype","multipart/form-data"),$(".bpolls-polls-option-html").length&&(poll_html=$(".bpolls-polls-option-html").html(),option_html=$(".bpolls-option").html()),bpolls_ajax_object.reign_polls&&document.body.classList.add("reign-polls"),bpolls_ajax_object.rt_poll_fix&&bpolls_ajax_object.nouveau&&($(document).on("click",".bpolls-icon",function(){$("#rtmedia-add-media-button-post-update").hide()}),$(document).on("click",".bpolls-cancel",function(){$("#rtmedia-add-media-button-post-update").show()}),$(document).on("focus","#whats-new",function(){$("#rtmedia-add-media-button-post-update").is(":hidden")&&$("#rtmedia-add-media-button-post-update").show()}),$(document).on("click","#rtmedia-add-media-button-post-update",function(){}),$(document).on("focus","#whats-new",function(){$(".bpolls-html-container").is(":hidden")&&$(".bpolls-html-container").show()})),$(document).on("click focus","#whats-new",function(){bpolls_ajax_object.buddyboss&&($("#whats-new-toolbar").append($(".bpolls-html-container")),$("#whats-new-attachments").append($(".bpolls-polls-option-html")),0==$(".whats-new-form-footer #whats-new-toolbar .bpolls-html-container").length)&&$(".bpolls-html-container").appendTo($(".whats-new-form-footer #whats-new-toolbar"))}),bpolls_ajax_object.buddyboss&&bpolls_ajax_object.allowed_polls&&(bb_pools_icon_push(),$(window).on("beforeunload",function(){clearInterval(bb_polls_Interval)}),$(document).on("click",".bb-model-close-button, .activity-update-form-overlay",function(){clearInterval(bb_polls_Interval),bb_pools_icon_push()}),$.ajaxPrefilter(function(options,originalOptions,jqXHR){try{if(null==originalOptions.data||void 0===originalOptions.data||void 0===originalOptions.data.action)return!0}catch(e){return!0}"post_update"==originalOptions.data.action&&(clearInterval(bb_polls_Interval),bb_pools_icon_push())})),$(document).on("focus","#whats-new",function(){$("#whats-new-options").addClass("bpolls-rtm-class")}),$(document).on("click",".bpolls-icon-dialog-cancel",function(){$(".bpolls-icon-dialog").removeClass("is-visible")}),$(document).on("click",".bpolls-add-option",function(){var max_options=bpolls_ajax_object.polls_option_lmit;$(this).parents(".bpolls-polls-option-html").find(".bpolls-option").length>=max_options?$(".bpolls-icon-dialog").addClass("is-visible"):((max_options=$(this).parent().siblings().find(".bpolls-option:first").clone().insertAfter($(this).parent().siblings().find(".bpolls-option:last"))).find("input").each(function(){this.value="",this.placeholder=""}),0==max_options.length&&$(this).parents(".bpolls-polls-option-html").find(".bpolls-sortable").html('<div class="bpolls-option">'+option_html+"</div>"))}),$(document).on("click",".bpolls-option-delete",function(){$(this).parent(".bpolls-option").remove()}),$(document).on("click",".bpolls-icon",function(){0!=$(".quote-btn").length&&($(".bg-type-input").val(""),$(".bg-type-value").val(""),$("#whats-new, #bppfa-whats-new").removeClass("quotesimg-bg-selected"),$("#whats-new, #bppfa-whats-new").removeClass("quotescolors-bg-selected"),$("#whats-new, #bppfa-whats-new").css("background-image",""),$("#whats-new, #bppfa-whats-new").css("background",""),$("#whats-new, #bppfa-whats-new").css("color",""),$(".bpquotes-selection").css("pointerEvents","auto")),0!=$(".bpchk-allow-checkin").length&&("undefined"!=typeof bpchk_public_js_obj&&$.ajax({dataType:"JSON",url:bpchk_public_js_obj.ajaxurl,type:"POST",data:{action:"bpchk_cancel_checkin"},success:function(response){$(".bpchk-checkin-temp-location").remove()},error:function(xhr,status,error){console.error("Check-in cancel failed:",error)}}),$("#bpchk-autocomplete-place").val(""),$("#bpchk-checkin-place-lat").val(""),$("#bpchk-checkin-place-lng").val(""),"undefined"!=typeof BPCHKPRO)&&(BPCHKPRO.delete_cookie("bpchkpro_lat"),BPCHKPRO.delete_cookie("bpchkpro_lng"),BPCHKPRO.delete_cookie("bpchkpro_place"),BPCHKPRO.delete_cookie("add_place")),$(".bpolls-polls-option-html").slideToggle(500),$(".bpolls-datetimepicker").datetimepicker({minDate:new Date()}),$(function(){$(".bpolls-sortable").sortable({handle:".bpolls-sortable-handle"}),$(".bpolls-sortable").disableSelection()})}),$(document).on("click",".bpolls-cancel",function(){$("#aw-whats-new-reset").trigger("click"),$(".bpolls-input").each(function(){$(this).val("")}),$(".bpolls-polls-option-html").html(poll_html),$(".bpolls-polls-option-html").slideUp(500),$(".bpolls-sortable").sortable({handle:".bpolls-sortable-handle"}),$(".bpolls-sortable").disableSelection()}),$(document).on("click",'#whats-new-form button[type="reset"], #whats-new-form .activity-post-cancel, #aw-whats-new-reset',function(){setTimeout(function(){bpollsResetPollForm()},100)}),$(document).on("click","#whats-new-form button",function(){"cancel"!==$(this).text().trim().toLowerCase()||$(this).hasClass("bpolls-cancel")||setTimeout(function(){bpollsResetPollForm()},100)}),$("#whats-new-form").on("reset",function(){setTimeout(function(){bpollsResetPollForm()},100)}),$(document).on("change","input.bpolls_input_options",function(){var poll_option=[],data=($("input.bpolls_input_options").each(function(){$(this).val()&&poll_option.push($(this).val())}),{action:"bpolls_set_poll_type_true",poll_option:poll_option,is_poll:0!==poll_option.length?"yes":"no",ajax_nonce:bpolls_ajax_object.ajax_nonce});$.post(bpolls_ajax_object.ajax_url,data,function(response){console.log(response)}).fail(function(xhr,status,error){console.error("Poll type update failed:",error)})});var pendingPostUpdate=!1;$.ajaxPrefilter(function(options,originalOptions,jqXHR){originalOptions.data&&("object"==typeof originalOptions.data&&"post_update"===originalOptions.data.action||"string"==typeof originalOptions.data&&-1!==originalOptions.data.indexOf("action=post_update"))&&(pendingPostUpdate=!0)}),$(document).ajaxComplete(function(event,xhr,settings){if(pendingPostUpdate)try{var response=xhr.responseJSON||JSON.parse(xhr.responseText);response&&(!0===response.success||"true"===response.success||response.id&&"number"==typeof response.id||response.activity&&response.activity.id||response.bp_activity_newest_activities)&&(pendingPostUpdate=!1,setTimeout(function(){$(".bpolls-polls-option-html").html(poll_html),$(".bpolls-polls-option-html").is(":visible")&&$(".bpolls-polls-option-html").slideUp(300),$("#bpolls-image-preview").attr("src",""),$("#bpolls-attachment-url").val(""),$(".bpolls-image-upload").hide(),$("#bpolls-video-preview").attr("src",""),$("#bpolls-video-attachment-url").val(""),$(".bpolls-video-upload").hide(),$("#bpolls-audio-preview").attr("src",""),$("#bpolls-audio-attachment-url").val(""),$(".bpolls-audio-upload").hide(),$("#whats-new").val(""),$("#whats-new-form").trigger("reset"),$("#aw-whats-new-reset").length&&$("#aw-whats-new-reset").trigger("click")},200))}catch(e){}}),$(document).on("click",".bpolls-vote-submit",function(e){e.preventDefault();for(var submit_event=$(this),e=$(this).html(),s_array=$(this).closest(".bpolls-vote-submit-form").serializeArray(),len=s_array.length,dataObj={},i=0;i<len;i++)dataObj[s_array[i].name]=s_array[i].value;var bpoll_activity_id=dataObj.bpoll_activity_id;null==dataObj["bpolls_vote_optn[]"]?submit_event.html(bpolls_ajax_object.optn_empty_text+' <i class="fa fa-exclamation-triangle"></i>'):(submit_event.html(e),submit_event.html(bpolls_ajax_object.submit_text+' <i class="fa fa-refresh fa-spin"></i>'),e={action:"bpolls_save_poll_vote",poll_data:$(this).closest(".bpolls-vote-submit-form").serialize(),ajax_nonce:bpolls_ajax_object.ajax_nonce},$.post(bpolls_ajax_object.ajax_url,e,function(response){response=JSON.parse(response);""!=response.bpolls_thankyou_feedback&&submit_event.after($('<span class="bpolls-feedback-message">').text(response.bpolls_thankyou_feedback)),$.each(response,function(i,item){i=submit_event.closest(".bpolls-vote-submit-form").find("#"+i);$(i).parents(".bpolls-item").find(".bpolls-item-width").animate({width:item.vote_percent},500),$(i).parents(".bpolls-item").find(".bpolls-percent").text(item.vote_percent),$(i).parents(".bpolls-check-radio-div").siblings(".bpolls-votes").html(item.bpolls_votes_txt),$(i).parents().parents(".bpolls-item").find(".bpolls-result-votes").html(item.bpolls_votes_content)}),$("#activity-"+bpoll_activity_id+" .bpolls-item input").hide(),$("#activity-"+bpoll_activity_id+" .bpolls-add-user-item").remove(),submit_event.remove()}).fail(function(xhr,status,error){console.error("Vote submission failed:",error),alert(bpolls_ajax_object.vote_error_msg||"Vote submission failed. Please try again.")}))}),$(document).on("click",".bpolls-icon",function(){jQuery(".bpquotes-bg-selection-div").hide(),jQuery(".bp-checkin-panel").hide()}),$(document).on("click",".bp-polls-view-all",function(e){e.preventDefault();e={action:"bpolls_activity_all_voters",activity_id:$(this).data("activity-id"),option_id:$(this).data("option-id"),ajax_nonce:bpolls_ajax_object.ajax_nonce};$.post(bpolls_ajax_object.ajax_url,e,function(response){response&&response.success&&response.data&&$("body").append(response.data)}).fail(function(xhr,status,error){console.error("Failed to load voters:",error)})}),$(document).on("click",".bpolls-modal-close.bpolls-modal-close-icon",function(e){$(".bpolls-icon-dialog.bpolls-user-votes-dialog").remove()}),$(document).on("keydown",".bpoll-add-user-option",function(e){var user_option,bpoll_activity_id,bpoll_user_id,user_count,add_option;13==e.keyCode&&""==$(this).val()&&(e.preventDefault(),bpoll_activity_id=$(this).data("activity-id"),$("#activity-"+bpoll_activity_id+" .bpolls-add-option-error").show(),setTimeout(function(){$("#activity-"+bpoll_activity_id+" .bpolls-add-option-error").hide(500)},5e3)),13==e.keyCode&&""!=$(this).val()&&(e.preventDefault(),e=bpolls_ajax_object.polls_option_lmit,user_option=$(this).val(),bpoll_activity_id=$(this).data("activity-id"),bpoll_user_id=$(this).data("user-id"),user_count=1,$("#activity-"+bpoll_activity_id+" .bpolls-item .bpolls-delete-user-option").each(function(){bpoll_user_id==$(this).data("user-id")&&user_count++}),e<user_count?(console.log(e+" =="+user_count),$(".bpolls-icon-dialog").addClass("is-visible")):(e={action:"bpolls_activity_add_user_option",activity_id:bpoll_activity_id,user_option:user_option,ajax_nonce:bpolls_ajax_object.ajax_nonce},add_option=$(this).parent(),$.post(bpolls_ajax_object.ajax_url,e,function(response){""!==(response=$.parseJSON(response)).add_poll_option&&($(response.add_poll_option).insertBefore(add_option),"yes"!=bpolls_ajax_object.poll_revoting)&&$("#activity-"+bpoll_activity_id+" .bpolls-vote-submit").trigger("click")}).fail(function(xhr,status,error){console.error("Failed to add option:",error)}),$(this).val("")))}),$(document).on("click",".bpoll-add-option",function(e){e.preventDefault();var bpoll_user_id,user_count,add_option,e=bpolls_ajax_object.polls_option_lmit,bpoll_activity_id=$(this).data("activity-id"),user_option=$("#activity-"+bpoll_activity_id+" .bpoll-add-user-option").val();""!=user_option?(bpoll_user_id=$(this).data("user-id"),user_count=1,$("#activity-"+bpoll_activity_id+" .bpolls-item .bpolls-delete-user-option").each(function(){bpoll_user_id==$(this).data("user-id")&&user_count++}),e<user_count?(console.log(e+" =="+user_count),$(".bpolls-icon-dialog").addClass("is-visible")):(e={action:"bpolls_activity_add_user_option",activity_id:bpoll_activity_id,user_option:user_option,ajax_nonce:bpolls_ajax_object.ajax_nonce},add_option=$(this).parent(),$.post(bpolls_ajax_object.ajax_url,e,function(response){""!==(response=$.parseJSON(response)).add_poll_option&&($(response.add_poll_option).insertBefore(add_option),"yes"!=bpolls_ajax_object.poll_revoting)&&$("#activity-"+bpoll_activity_id+" .bpolls-vote-submit").trigger("click")}).fail(function(xhr,status,error){console.error("Failed to add option:",error)}),$("#activity-"+bpoll_activity_id+" .bpoll-add-user-option").val())):($("#activity-"+bpoll_activity_id+" .bpolls-add-option-error").show(),setTimeout(function(){$("#activity-"+bpoll_activity_id+" .bpolls-add-option-error").hide(500)},5e3))}),$(document).on("click",".bpolls-delete-user-option",function(e){var bpoll_activity_id,submit_event;e.preventDefault(),1==confirm(bpolls_ajax_object.delete_polls_msg)&&(e=$(this).data("option"),e={action:"bpolls_activity_delete_user_option",activity_id:bpoll_activity_id=$(this).data("activity-id"),user_option:e,ajax_nonce:bpolls_ajax_object.ajax_nonce},submit_event=$("#activity-"+bpoll_activity_id+" .bpolls-vote-submit"),$(this).parent().remove(),$.post(bpolls_ajax_object.ajax_url,e,function(response){console.log(response);response=JSON.parse(response);$.each(response,function(i,item){i=submit_event.closest(".bpolls-vote-submit-form").find("#"+i);$(i).parents(".bpolls-item").find(".bpolls-item-width").animate({width:item.vote_percent},500),$(i).parents(".bpolls-item").find(".bpolls-percent").text(item.vote_percent),$(i).parents(".bpolls-check-radio-div").siblings(".bpolls-votes").html(item.bpolls_votes_txt),$(i).parents().parents(".bpolls-item").find(".bpolls-result-votes").html(item.bpolls_votes_content)})}).fail(function(xhr,status,error){console.error("Failed to delete option:",error)}))})})})(jQuery),($=>{$(document).ready(function(){var file_frame_image,file_frame_video,file_frame_audio;function initCharCounter(input){var $counter,$input=$(input),limit=parseInt($input.data("char-limit"),10);!limit||limit<=0||0<$input.next(".bpolls-char-counter").length||($counter=$('<div class="bpolls-char-counter"></div>'),$input.after($counter),updateCharCounter($input,$counter,limit),$input.on("input keyup",function(){updateCharCounter($input,$counter,limit)}))}function updateCharCounter($input,$counter,limit){var $input=$input.val().length,percentage=$input/limit*100,$input=$input+" / "+limit;void 0!==bpolls_ajax_object.characters_text&&($input+=" "+bpolls_ajax_object.characters_text),$counter.text($input),$counter.removeClass("warning danger"),100<=percentage?$counter.addClass("danger"):80<=percentage&&$counter.addClass("warning")}$(document).on("click","#bpolls-attach-image",function(event){event.preventDefault(),file_frame_image?file_frame_image.open():(event={type:"image"},"yes"===bpolls_ajax_object.restrict_media_library&&(event.author=bpolls_ajax_object.poll_user),(file_frame_image=wp.media.frames.file_frame=wp.media({title:bpolls_ajax_object.add_image_title||"Select Image",button:{text:bpolls_ajax_object.add_image_button||"Use Image"},multiple:!1,library:event})).on("select",function(){var attachment=file_frame_image.state().get("selection").first().toJSON();bpolls_ajax_object.max_upload_size&&attachment.filesizeInBytes>bpolls_ajax_object.max_upload_size?alert(bpolls_ajax_object.file_too_large):($("#bpolls-image-preview").attr("src",attachment.url),$("#bpolls-attachment-url").val(attachment.url),$(".bpolls-image-upload").show(),attachment.url&&(attachment={action:"bpolls_save_image",image_url:attachment.url,ajax_nonce:bpolls_ajax_object.ajax_nonce},$.post(bpolls_ajax_object.ajax_url,attachment,function(response){}).fail(function(xhr,status,error){console.error("Failed to save image:",error)})))}),file_frame_image.open(),$(".media-router button:first-child").click())}),$(document).on("click","#bpolls-attach-video",function(event){event.preventDefault(),file_frame_video?file_frame_video.open():(event={type:"video"},"yes"===bpolls_ajax_object.restrict_media_library&&(event.author=bpolls_ajax_object.poll_user),(file_frame_video=wp.media.frames.file_frame=wp.media({title:bpolls_ajax_object.add_video_title||"Select Video",button:{text:bpolls_ajax_object.add_video_button||"Use Video"},multiple:!1,library:event})).on("select",function(){var attachment=file_frame_video.state().get("selection").first().toJSON();bpolls_ajax_object.max_upload_size&&attachment.filesizeInBytes>bpolls_ajax_object.max_upload_size?alert(bpolls_ajax_object.file_too_large):($("#bpolls-video-preview").attr("src",attachment.url),$("#bpolls-video-attachment-url").val(attachment.url),$(".bpolls-video-upload").show())}),file_frame_video.open(),$(".media-router button:first-child").click())}),$(document).on("click","#bpolls-attach-audio",function(event){event.preventDefault(),file_frame_audio?file_frame_audio.open():(event={type:"audio"},"yes"===bpolls_ajax_object.restrict_media_library&&(event.author=bpolls_ajax_object.poll_user),(file_frame_audio=wp.media.frames.file_frame=wp.media({title:bpolls_ajax_object.add_audio_title||"Select Audio",button:{text:bpolls_ajax_object.add_audio_button||"Use Audio"},multiple:!1,library:event})).on("select",function(){var attachment=file_frame_audio.state().get("selection").first().toJSON();bpolls_ajax_object.max_upload_size&&attachment.filesizeInBytes>bpolls_ajax_object.max_upload_size?alert(bpolls_ajax_object.file_too_large):($("#bpolls-audio-preview").attr("src",attachment.url),$("#bpolls-audio-attachment-url").val(attachment.url),$(".bpolls-audio-upload").show())}),file_frame_audio.open(),$(".media-router button:first-child").click())}),$(document).on("click",".bpolls-remove-media",function(e){e.preventDefault();var videoEl,e=$(this).data("media-type");"image"===e?($("#bpolls-image-preview").attr("src",""),$("#bpolls-attachment-url").val(""),$(".bpolls-image-upload").hide()):"video"===e?((videoEl=$("#bpolls-video-preview")[0])&&videoEl.pause(),$("#bpolls-video-preview").attr("src",""),$("#bpolls-video-attachment-url").val(""),$(".bpolls-video-upload").hide()):"audio"===e&&((videoEl=$("#bpolls-audio-preview")[0])&&videoEl.pause(),$("#bpolls-audio-preview").attr("src",""),$("#bpolls-audio-attachment-url").val(""),$(".bpolls-audio-upload").hide())}),$(document).on("click",".bpolls-url-preview-btn",function(e){e.preventDefault();var videoEl,e=$(this).closest(".bpolls-url-input-wrap"),mediaType=e.data("media-type"),e=e.find(".bpolls-media-url-input").val().trim();e?"image"===mediaType?($("#bpolls-image-preview").attr("src",e),$("#bpolls-attachment-url").val(e),$(".bpolls-image-upload").show(),e&&"undefined"!=typeof bpolls_ajax_object&&$.post(bpolls_ajax_object.ajax_url,{action:"bpolls_save_image",image_url:e,ajax_nonce:bpolls_ajax_object.ajax_nonce})):"video"===mediaType?(videoEl=$("#bpolls-video-preview")[0],$("#bpolls-video-preview").attr("src",e),$("#bpolls-video-attachment-url").val(e),$(".bpolls-video-upload").show(),videoEl&&videoEl.load(),e&&"undefined"!=typeof bpolls_ajax_object&&$.post(bpolls_ajax_object.ajax_url,{action:"bpolls_save_video",video_url:e,ajax_nonce:bpolls_ajax_object.ajax_nonce})):"audio"===mediaType&&(videoEl=$("#bpolls-audio-preview")[0],$("#bpolls-audio-preview").attr("src",e),$("#bpolls-audio-attachment-url").val(e),$(".bpolls-audio-upload").show(),videoEl&&videoEl.load(),e)&&"undefined"!=typeof bpolls_ajax_object&&$.post(bpolls_ajax_object.ajax_url,{action:"bpolls_save_audio",audio_url:e,ajax_nonce:bpolls_ajax_object.ajax_nonce}):alert("Please enter a URL")}),$(".bpolls_input_options[data-char-limit]").each(function(){initCharCounter(this)}),$("#bpolls-thankyou-feedback[data-char-limit]").each(function(){initCharCounter(this)}),$(document).on("focus",".bpolls_input_options[data-char-limit]",function(){initCharCounter(this)}),$(document).on("focus","#bpolls-thankyou-feedback[data-char-limit]",function(){initCharCounter(this)})})})(jQuery);